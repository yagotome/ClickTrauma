package br.com.yagotome.clicktrauma.dao;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import static org.junit.Assert.*;

import br.com.yagotome.clicktrauma.modelo.Usuario;

public class UsuarioDaoTest {
	private EntityManagerFactory factory;
	private EntityManager manager;
	private UsuarioDao dao;
	@Before
	public void init() {
		factory = Persistence
				.createEntityManagerFactory("ClickTrauma");
		manager = factory.createEntityManager();
		dao = new UsuarioDaoImpl(manager);
	}
	
	@After
	public void destroy() {
		manager.close();
		factory.close();
	}
	
	@Test
	public void testInsere() {
		Usuario usuario = new Usuario("Yago Tomé", "yagotome", "1234");
		usuario.setEmail("yagotome@gmail.com");
		usuario.setUf("RJ");
		dao.insere(usuario);
	}

	@Test
	public void testAtualiza() {
		Usuario usuario = dao.getById(2L);
		usuario.setSenha("123456");
		dao.atualiza(usuario);
	}

	@Test
	public void testGetById() {
		Usuario usuario = dao.getById(1L);
		assertEquals("Yago Tomé", usuario.getNome());
		assertEquals("yagotome", usuario.getLogin());
		assertEquals("123456", usuario.getSenha());
		assertEquals("yagotome@gmail.com", usuario.getEmail());
		assertEquals("RJ", usuario.getUf());
		assertNull(usuario.getCpf());
		assertNull(usuario.getEspecialidade());
		assertNull(usuario.getProfissao());
	}
}
